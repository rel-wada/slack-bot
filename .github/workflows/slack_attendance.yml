name: "Slack Attendance Bot"

on:
  schedule:
    - cron: '0 9 * * *'  # æ¯æœ9æ™‚ï¼ˆUTCãªã®ã§æ—¥æœ¬æ™‚é–“+9h â†’ JST18æ™‚ï¼‰

  workflow_dispatch:  # æ‰‹å‹•å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

jobs:
  post_attendance:
    runs-on: ubuntu-latest

    steps:
      - name: Send Slack message
        run: |
          curl -X POST "https://slack.com/api/chat.postMessage" \
          -H "Authorization: Bearer ${{ secrets.SLACK_BOT_TOKEN }}" \
          -H "Content-Type: application/json" \
          --data '{
            "channel": "${{ secrets.SLACK_CHANNEL_ID }}",
            "text": "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ å‡ºå‹¤ãƒ»é€€å‹¤ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚",
            "blocks": [
              {
                "type": "section",
                "text": { "type": "mrkdwn", "text": "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ å‡ºå‹¤ãƒ»é€€å‹¤ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚" }
              },
              {
                "type": "actions",
                "elements": [
                  {
                    "type": "button",
                    "text": { "type": "plain_text", "text": "ğŸš€ å‡ºå‹¤" },
                    "style": "primary",
                    "action_id": "attendance_checkin",
                    "value": "checkin"
                  },
                  {
                    "type": "button",
                    "text": { "type": "plain_text", "text": "ğŸ é€€å‹¤" },
                    "style": "danger",
                    "action_id": "attendance_checkout",
                    "value": "checkout"
                  }
                ]
              }
            ]
          }'
